<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🇨🇲 Webhook Inspector Cameroon - Genuka</title>
    <link rel="stylesheet" href="/styles/cameroon.css">
    <link rel="stylesheet" href="/styles/components.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🇨🇲</text></svg>">
</head>
<body>
    <!-- Header Camerounais -->
    <header class="header-cameroon">
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <span class="flag">🇨🇲</span>
                    <h1>Webhook Inspector Cameroon</h1>
                    <span class="subtitle">Genuka API Debugging Tool</span>
                </div>
                <div class="header-actions">
                    <div class="theme-toggle">
                        <button id="theme-toggle" title="Basculer le thème">🌓</button>
                    </div>
                    <div class="lang-toggle">
                        <select id="lang-toggle">
                            <option value="fr">🇫🇷 Français</option>
                            <option value="en">🇬🇧 English</option>
                        </select>
                    </div>
                    <div class="connection-status">
                        <span id="connection-status" class="status-disconnected">⚫ Déconnecté</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Dashboard Principal -->
    <main class="main-dashboard">
        <div class="container">
            
            <!-- Métriques Temps Réel -->
            <section class="metrics-section">
                <div class="metrics-grid">
                    <div class="metric-card total">
                        <div class="metric-icon">📊</div>
                        <div class="metric-content">
                            <div class="metric-value" id="total-webhooks">0</div>
                            <div class="metric-label">Total Webhooks</div>
                        </div>
                    </div>
                    
                    <div class="metric-card today">
                        <div class="metric-icon">📅</div>
                        <div class="metric-content">
                            <div class="metric-value" id="today-webhooks">0</div>
                            <div class="metric-label">Aujourd'hui</div>
                        </div>
                    </div>
                    
                    <div class="metric-card valid">
                        <div class="metric-icon">✅</div>
                        <div class="metric-content">
                            <div class="metric-value" id="valid-webhooks">0</div>
                            <div class="metric-label">Signatures Valides</div>
                        </div>
                    </div>
                    
                    <div class="metric-card invalid">
                        <div class="metric-icon">❌</div>
                        <div class="metric-content">
                            <div class="metric-value" id="invalid-webhooks">0</div>
                            <div class="metric-label">Erreurs</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Contrôles et Filtres -->
            <section class="controls-section">
                <div class="controls-grid">
                    <div class="search-box">
                        <input type="text" id="search-input" placeholder="Chercher dans les webhooks..." />
                        <button id="search-btn">🔍</button>
                    </div>
                    
                    <div class="filters">
                        <select id="event-filter">
                            <option value="">Tous les événements</option>
                        </select>
                        
                        <select id="company-filter">
                            <option value="">Toutes les sociétés</option>
                        </select>
                        
                        <select id="signature-filter">
                            <option value="">Toutes les signatures</option>
                            <option value="true">Valides uniquement</option>
                            <option value="false">Invalides uniquement</option>
                        </select>
                        
                        <input type="date" id="date-filter" />
                    </div>
                    
                    <div class="actions">
                        <button id="refresh-btn" class="btn-primary">🔄 Actualiser</button>
                        <button id="export-btn" class="btn-secondary">📥 Exporter</button>
                        <button id="test-btn" class="btn-accent">🧪 Test</button>
                        <button id="clear-btn" class="btn-danger">🗑️ Nettoyer</button>
                    </div>
                </div>
            </section>

            <!-- Timeline des Webhooks -->
            <section class="timeline-section">
                <div class="section-header">
                    <h2>📡 Timeline des Webhooks</h2>
                    <div class="auto-refresh">
                        <label>
                            <input type="checkbox" id="auto-refresh" checked />
                            Actualisation automatique
                        </label>
                    </div>
                </div>
                
                <div class="timeline-container">
                    <div id="webhooks-list" class="webhooks-list">
                        <!-- Les webhooks seront affichés ici -->
                        <div class="empty-state">
                            <div class="empty-icon">📭</div>
                            <h3>Aucun webhook pour le moment</h3>
                            <p>Les webhooks apparaîtront ici en temps réel dès qu'ils arrivent.</p>
                            <button id="create-test-webhook" class="btn-primary">Créer un webhook de test</button>
                        </div>
                    </div>
                </div>
                
                <!-- Pagination -->
                <div class="pagination">
                    <button id="prev-page" class="btn-secondary" disabled>← Précédent</button>
                    <span id="page-info">Page 1</span>
                    <button id="next-page" class="btn-secondary">Suivant →</button>
                </div>
            </section>

        </div>
    </main>

    <!-- Modal pour les détails du webhook -->
    <div id="webhook-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Détails du Webhook</h3>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="webhook-details">
                    <!-- Contenu dynamique -->
                </div>
            </div>
            <div class="modal-footer">
                <button id="replay-webhook" class="btn-primary">🔄 Rejouer</button>
                <button id="copy-webhook" class="btn-secondary">📋 Copier</button>
                <button class="btn-secondary modal-close">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Toast pour les notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <span>🇨🇲 Webhook Inspector Cameroon</span>
                    <span>Made with ❤️ by Genuka Team</span>
                </div>
                <div class="footer-right">
                    <span id="current-time"></span>
                    <span>Timezone: Africa/Douala (WAT)</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="/utils/api.js"></script>
    <script src="/utils/websocket.js"></script>
    <script src="/components/Dashboard.js"></script>
    <script src="/components/WebhookList.js"></script>
    <script src="/components/JSONViewer.js"></script>
    
    <!-- Script principal -->
    <script>
        // Initialisation de l'application
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🇨🇲 Webhook Inspector Cameroon - Initialisation...');
            
            // Initialiser les composants
            Dashboard.init();
            WebhookList.init();
            WebsocketClient.init();
            
            // Démarrer l'horloge
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            console.log('✅ Application initialisée avec succès !');
        });

        // Mettre à jour l'heure actuelle
        function updateCurrentTime() {
            const now = new Date();
            const cameroonTime = now.toLocaleString('fr-FR', {
                timeZone: 'Africa/Douala',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            const timeElement = document.getElementById('current-time');
            if (timeElement) {
                timeElement.textContent = cameroonTime;
            }
        }
    </script>
</body>
</html>